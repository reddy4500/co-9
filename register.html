<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CO-DOCTOR | Register</title>
    <link rel="stylesheet" href="style.css">
    <!-- Supabase JS client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="navbar-left">
            <img src="logo.jpeg" class="logo" alt="CO-DOCTOR Logo">
            <span class="brand-name">CO-DOCTOR</span>
        </div>
        <ul class="navbar-center">
            <li><a href="index.html">Home</a></li>
            <li><a href="#">About</a></li>
        </ul>
        <div class="navbar-right">
            <a href="login.html" class="login-btn" id="login-btn">Login</a>
        </div>
    </nav>
    <section class="main-section">
        <div class="form-container">
            <h2>Register</h2>
            <form id="register-form" onsubmit="event.preventDefault(); register();">
                <input type="text" id="reg-fullname" placeholder="Full Name" required>
                <input type="text" id="reg-phone" placeholder="Phone Number" required>
                <input type="email" id="reg-username" placeholder="Email" required>
                <input type="password" id="reg-password" placeholder="Password" required>
                <button type="submit" class="btn">Register</button>
                <div id="register-error"></div>
            </form>
            <p class="text-center">Already have an account? <a href="login.html">Login here</a></p>
        </div>
    </section>
    <script>
        // --- Supabase Initialization ---
        const SUPABASE_URL = "https://kxzkuphsoihlzjwbhghl.supabase.co";
        const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt4emt1cGhzb2lobHpqd2JoZ2hsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU3NjcyNTIsImV4cCI6MjA2MTM0MzI1Mn0.6Fa0GLY82aMO19boMFeAfWypeuMflxi90jpOq12s0K8";
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        async function register() {
            const fullname = document.getElementById('reg-fullname').value.trim();
            const phone = document.getElementById('reg-phone').value.trim();
            const email = document.getElementById('reg-username').value.trim();
            const password = document.getElementById('reg-password').value.trim();
            const errorElem = document.getElementById('register-error');
            errorElem.textContent = "";

            if (!fullname || !phone || !email || !password) {
                errorElem.textContent = "Please fill in all fields.";
                errorElem.style.color = "red";
                return;
            }
            if (!/^\d{10}$/.test(phone)) {
                errorElem.textContent = "Please enter a valid 10-digit phone number.";
                errorElem.style.color = "red";
                return;
            }

            // Supabase Auth sign up
            const { data, error } = await supabase.auth.signUp({
                email: email,
                password: password,
                options: {
                    data: {
                        fullname: fullname,
                        phone: phone
                    }
                }
            });

            if (error) {
                errorElem.textContent = error.message || "Registration failed.";
                errorElem.style.color = "red";
                return;
            }

            errorElem.style.color = "green";
            errorElem.textContent = "Registration successful! Please check your email to confirm your account.";
            setTimeout(() => {
                window.location.href = 'login.html';
            }, 2000);
        }
    </script>
</body>
</html>

