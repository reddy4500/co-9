<!-- system.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>System Details | CO-DOCTOR</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="navbar">
        <div class="navbar-left">
            <img src="logo.jpg" class="logo" alt="CO-DOCTOR Logo">
            <span class="brand-name">CO-DOCTOR</span>
        </div>
        <ul class="navbar-center">
            <li><a href="index.html">Home</a></li>
            <li><a href="system.html" class="active">Systems</a></li>
            <!-- Dynamic login/logout links -->
            <li id="nav-login"><a href="login.html">Login</a></li>
            <li id="nav-register"><a href="register.html">Register</a></li>
        </ul>
        <div class="navbar-right">
            <span id="doctor-credentials"></span>
            <button class="logout-btn" id="logout-btn" style="display:none;" onclick="logout()">Logout</button>
        </div>
    </nav>

    <section class="main-section">
        <h1 id="system-name">System Details</h1>
        <div class="subsystem-list" id="subsystem-list"></div>
    </section>

    <script>
    // SYSTEMS DATA (same as before)
    const systems = [ /* ... */ ];

    // Updated function to show system details without login check
    function displaySystemDetails() {
        const urlParams = new URLSearchParams(window.location.search);
        const systemId = urlParams.get('system');
        
        if (!systemId) {
            window.location.href = 'index.html';
            return;
        }

        const system = systems.find(s => s.id == systemId);
        if (!system) {
            window.location.href = 'index.html';
            return;
        }

        document.getElementById('system-name').textContent = `${system.id}. ${system.name}`;
        const assignments = JSON.parse(localStorage.getItem('assignments') || '{}');
        const subsystemList = document.getElementById('subsystem-list');

        system.subsystems.forEach(subsystem => {
            const subsystemItem = document.createElement('div');
            subsystemItem.className = 'subsystem-item';
            
            subsystemItem.innerHTML = `
                <div class="subsystem-header">${subsystem}</div>
                <div class="doctors-list" id="doctors-${system.id}-${subsystem}"></div>
            `;

            const doctors = assignments[system.id]?.[subsystem] || [];
            const doctorsList = subsystemItem.querySelector('.doctors-list');
            
            doctors.forEach(doctor => {
                doctorsList.innerHTML += `
                    <div class="doctor-card">
                        <div class="doctor-name">Dr. ${doctor.fullname}</div>
                        <div class="doctor-phone">Phone: ${doctor.phone}</div>
                    </div>
                `;
            });

            if (doctors.length === 0) {
                doctorsList.innerHTML = '<div class="no-assignments">No doctors assigned yet</div>';
            }

            subsystemList.appendChild(subsystemItem);
        });
    }

    // Updated navbar handling
    document.addEventListener('DOMContentLoaded', function() {
        // Always show system details
        displaySystemDetails();

        // Update navbar based on login status
        const loggedIn = localStorage.getItem('loggedIn');
        const username = localStorage.getItem('username');
        const users = JSON.parse(localStorage.getItem('users') || '{}');
        const user = users[username];

        if (loggedIn && user) {
            document.getElementById('nav-login').style.display = 'none';
            document.getElementById('nav-register').style.display = 'none';
            document.getElementById('logout-btn').style.display = '';
            document.getElementById('doctor-credentials').textContent = 
                `Dr. ${user.fullname || username} | ${user.phone || 'N/A'}`;
        } else {
            document.getElementById('logout-btn').style.display = 'none';
            document.getElementById('doctor-credentials').textContent = '';
        }
    });
    </script>
</body>
</html>
