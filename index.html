<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Doctors Availability | CO-DOCTOR</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Existing styles remain unchanged */
        .subsystem-list {
            margin-top: 15px;
            background: #e6f0ff;
            border-radius: 12px;
            padding: 15px;
            display: none;
        }
        .subsystem-item {
            margin-bottom: 12px;
            padding: 10px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        }
        .subsystem-header {
            color: #003366;
            font-weight: 600;
            margin-bottom: 8px;
        }
        .doctor-card {
            padding: 8px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 4px;
            font-size: 0.95em;
        }
        .doctor-card span {
            display: block;
        }
        .doctor-name {
            font-weight: 500;
            color: #2c3e50;
        }
        .doctor-phone {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        .no-assignments {
            color: #95a5a6;
            font-style: italic;
        }
        .system-box.active {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <!-- Navbar (unchanged) -->
    <nav class="navbar">
        <div class="navbar-left">
            <img src="logo.jpeg" class="logo" alt="CO-DOCTOR Logo">
            <span class="brand-name">CO-DOCTOR</span>
        </div>
        <ul class="navbar-center">
            <li><a href="index.html" class="active">Home</a></li>
            <li><a href="#">About</a></li>
        </ul>
        <div class="navbar-right">
            <a href="login.html" class="login-btn">Login</a>
        </div>
    </nav>

    <!-- Main Section -->
    <section class="main-section">
        <h1>Hospital Systems</h1>
        <div class="system-grid" id="system-grid"></div>
    </section>

    <script>
        // Systems data (same as form.html)
        const systems = [
            {id: 1, name: "Respiratory Medicine (Pulmo)", subsystems: ["RICU", "TB and exam ward", "OP", "Casualty"]},
            {id: 2, name: "Pediatrics", subsystems: ["Wards", "PICU", "OP"]},
            // ... include all systems from form.html ...
        ];

        // Load assignments and render systems
        function renderSystems() {
            const systemGrid = document.getElementById('system-grid');
            const assignments = JSON.parse(localStorage.getItem('assignments') || '{}');

            systems.forEach(system => {
                const systemBox = document.createElement('div');
                systemBox.className = 'system-box';
                systemBox.innerHTML = `
                    <div class="system-title">${system.id}. ${system.name}</div>
                    <div class="subsystem-list" id="subs-${system.id}"></div>
                `;

                const subsContainer = systemBox.querySelector(`#subs-${system.id}`);
                system.subsystems.forEach(sub => {
                    const subDiv = document.createElement('div');
                    subDiv.className = 'subsystem-item';
                    subDiv.innerHTML = `
                        <div class="subsystem-header">${sub}</div>
                        <div class="doctor-list" id="docs-${system.id}-${sub}"></div>
                    `;

                    const doctors = assignments[system.id]?.[sub] || [];
                    const docsDiv = subDiv.querySelector(`#docs-${system.id}-${sub}`);
                    
                    if(doctors.length > 0) {
                        doctors.forEach(doctor => {
                            docsDiv.innerHTML += `
                                <div class="doctor-card">
                                    <span class="doctor-name">${doctor.fullname}</span>
                                    <span class="doctor-phone">${doctor.phone}</span>
                                </div>
                            `;
                        });
                    } else {
                        docsDiv.innerHTML = `<div class="no-assignments">No doctors assigned yet</div>`;
                    }

                    subsContainer.appendChild(subDiv);
                });

                systemGrid.appendChild(systemBox);
            });
        }

        // Check login status
        function loadHome() {
            const loggedIn = localStorage.getItem('loggedIn');
            const username = localStorage.getItem('username');
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            
            if (!loggedIn || !users[username]) {
                window.location.href = 'login.html';
                return;
            }
            
            renderSystems();
        }

        // Initial load
        loadHome();
    </script>
</body>
</html>

